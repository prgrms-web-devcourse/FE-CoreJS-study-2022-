# 4ì¥ ì½œë°±í•¨ìˆ˜(ë°œí‘œìš©)

## ì½œë°± í•¨ìˆ˜ë€

: ëˆ„êµ°ê°€ ë¶ˆëŸ¬ì¤˜ì„œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜

- ë‹¤ë¥¸ ì½”ë“œì˜ ì¸ìë¡œ ë„˜ê²¨ì£¼ëŠ” í•¨ìˆ˜ (ì „ë‹¬ ë°›ì€ í•¨ìˆ˜ëŠ” ê³ ì°¨í•¨ìˆ˜ë¼ê³  í•œë‹¤)
- ë‹¤ë¥¸ ì½”ë“œì— ì œì–´ê¶Œë„ ê°™ì´ ìœ„ì„í•œë‹¤

**ì™œ í•„ìš”í•œê°€, ì˜ì˜**

- í•¨ìˆ˜ë¥¼ ì—¬ëŸ¬ë²ˆ ì“¸ ìˆ˜ ìˆê²Œ ë¨. ì¬í™œìš©ì„±ê³¼ ê´€ë¦¬ê°€ ìš©ì´í•´ì§„ë‹¤
- ë¹„ë™ê¸° í†µì‹ ì´ ê°€ëŠ¥í•´ì§„ë‹¤ (ë°‘ì—ì„œ ì„¤ëª…)

## ì œì–´ê¶Œ

### 1. í˜¸ì¶œ ì‹œì 

: ì½œë°± í•¨ìˆ˜ í˜¸ì¶œ ì‹œì ì— ëŒ€í•œ ì œì–´ê¶Œì„ ê°€ì§„ë‹¤

```jsx
let count = 0
let callbackFunction = () => {
  console.log(count)
  if (++count > 4) clearInterval(timer)
}
let timer = setInterval(callbackFunction, 500)
```

![Untitled](https://user-images.githubusercontent.com/95457808/175897401-0d100567-67f1-4eff-a4b2-c9312b0a1390.png)

â‡’ ë¶€ë¥¸ ì• ê°€ ì£¼ì¸ì´ ëœë‹¤

(setIntervalì— ë„£ìœ¼ë©´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„, ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ê±°ë“ . ê·¸ë˜ì„œ í˜¸ì¶œ ì£¼ì²´ê°€ setIntervalì´ë¼ê³  ì¨ë†“ì€ ë“¯)

### 2. ì¸ì

: í˜¸ì¶œí•˜ëŠ” ì£¼ì²´ì—ì„œ ì´ë¯¸ ì¸ì ìˆœì„œê°€ ì •í•´ì ¸ìˆë‹¤. ìˆœì„œë¥¼ ë°”ê¿€ ìˆ˜ ì—†ë‹¤
ì™œëƒí•˜ë©´ ì½œë°±í•¨ìˆ˜ê°€ ì´ë¯¸ ê²°ì • í•´ë†¨ê±°ë“ 

```jsx
const arr = [1, 2, 3, 4, 5]
const arrAdd1 = arr.map((value, index) => {
  return value + 3
})
// arrAdd1 : [4,5,6,7,8]
const arrAdd2 = arr.map((index, value) => {
  return value + 3
})
// arrAdd2 : [3,4,5,6,7] (ì¸ë±ìŠ¤ ê°’ì´ ì ìš©ëœ ìƒíƒœì´ë‹¤)
```

í•´ë‹¹ ì½œë°±í•¨ìˆ˜ì˜ **ì¸ì ìˆœì„œê°€ ì •í•´ì ¸ ìˆê¸° ë•Œë¬¸ì—** ì´ë¦„ì´ ê°™ë”ë¼ë„ ì„œìˆœì´ ë°”ë€Œë©´ ì•ˆëœë‹¤

### 3. this

- ê° ì½œë°±í•¨ìˆ˜ì˜ this
    
    ```jsx
    setTimeout(function() {console.log(this); }, 300);   // (1) Window { ... }
    
    [1,2,3,4,5].forEach(function (x) {
    	console.log(this);  // (2) Window { ... }
    });
    
    document.body.innetHTML += '<button id="a">í´ë¦­</button>';
    document.body.querySelector('#a').addEventListener('click', function(e) {
    	console.log(this, e);  // (3) <button id="a">í´ë¦­</button>
    	}   // MouseEvent { isTrusted: true, ... }
    );
    ```
    
    - (1)ì˜ setTimeoutì€ ë‚´ë¶€ì—ì„œ ì½œë°± í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ call ë©”ì„œë“œì˜ ì²« ë²ˆì§¸ ì¸ìì— ì „ì—­ê°ì²´ë¥¼ ë„˜ê¸°ê¸° ë•Œë¬¸ì— ì½œë°±í•¨ìˆ˜ ë‚´ë¶€ì—ì„œì˜ thisëŠ” ì „ì—­ê°ì²´ì…ë‹ˆë‹¤.
    - (2)ì˜forEachëŠ” 'ë³„ë„ì˜ ì¸ìë¡œ thisë¥¼ ë°›ëŠ” ê²½ìš°'ì§€ë§Œ ë³„ë„ì˜ ì¸ìë¡œ thisë¥¼ ë„˜ê¸°ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—ì „ì—­ê°ì²´ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.
    - (3)ì˜addEventListenerëŠ”ë‚´ë¶€ì—ì„œ ì½œë°± í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ call ë©”ì„œë“œì˜ ì²« ë²ˆì§¸ ì¸ìì— addEventListener ë©”ì„œë“œì˜ thisë¥¼ ê·¸ëŒ€ë¡œ ë„˜ê¸°ë„ë¡ ì •ì˜ë˜ì–´ ìˆì–´ì„œ ì½œë°± í•¨ìˆ˜ ë‚´ë¶€ì—ì„œì˜ thisê°€ addEventListenerë¥¼ í˜¸ì¶œí•œ ì£¼ì²´ì¸ HTML Elementë¥¼ ê°€ë¦¬í‚¤ê²Œ ë©ë‹ˆë‹¤.
    

<aside>
ğŸ€ thisì— ë‹¤ë¥¸ ê°’ ë°”ì¸ë”© (ì˜ë„ì ìœ¼ë¡œ í•´ë‹¹ ê°ì²´ë¥¼ ë°”ë¼ë³´ê²Œ í•˜ê³  ì‹¶ì„ ë•Œ)

</aside>

- callback í•¨ìˆ˜ ì œì–´ê¶Œì´ ìˆëŠ” í•¨ìˆ˜ì—ì„œ
    - ì•„ë¬´ ì²˜ë¦¬ ì—†ì´ í˜¸ì¶œí•˜ë©´ callback ë‚´ë¶€ì˜ thisëŠ” ì „ì—­ ê°ì²´ê°€ ëœë‹¤.
1. ë³„ë„ì˜ í• ë‹¹ (call/apply)ë“±ì„ í†µí•´ ë„˜ê²¨ë°›ì€ thisArgë¥¼ this bindingí•œ ì±„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
let userData = {
    signUp: '2020-10-06 15:00:00',
    id: 'minidoo',
    name: 'Not Set',
    setName: function(firstName, lastName) {
        this.name = firstName + ' ' + lastName;
    }
}
 
function getUserName(firstName, lastName, callback) {
    callback(firstName, lastName);
}
 
getUserName('PARK', 'MINIDDO', userData.setName);
 
// ê·¸ëƒ¥ ë©”ì„œë“œ í•¨ìˆ˜ë¡œ í˜¸ì¶œë  ë•Œ 
console.log('1: ', userData.name); // Not Set
console.log('2: ', window.name); // PARK MINIDDO

// call ì‚¬ìš© (thisëŠ” ë°˜ë“œì‹œ objê°€ ëœë‹¤)
function getUserName(firstName, lastName, callback, obj) {
    callback.call(obj, firstName, lastName); // - (1)
}
 
getUserName('PARK', 'MINIDDO', userData.setName, userData); //	- (2)
 
console.log(userData.name);
 
<output>
PARK MINIDDO
```

1. ë³„ë„ì˜ ë³€ìˆ˜Â `self`ì— thisë¥¼ ë‹´ì•„ì„œ í´ë¡œì €ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

```jsx
// 4-8 ì½œë°± í•¨ìˆ˜ ë‚´ë¶€ì˜ thisì— ë‹¤ë¥¸ ê°’ì„ ë°”ì¸ë”©í•˜ëŠ” ë°©ë²•(1)

var obj1 = {
	name : 'obj1 name',
	func : function() {
		var self = this;
		return function() {
			console.log(self.name);
		};
	}
};

var callback = obj1.func();
setTimeout(callback, 1000); // obj1 name
```

1. bind í™œìš©

```jsx
let obj1 = {
  name : 'obj1 name',
  func : function() {
    return function() {
      console.log(this.name);
    }
  }
}
let callback = obj1.func().bind(obj1);
setTimeout(callback, 1000); // obj1 name
```

## ****ë¹„ë™ê¸° ì œì–´ì™€ Callback Hell****

### ë¹„ë™ê¸° í†µì‹ ê³¼ ì½œë°± í•¨ìˆ˜

- ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¨ì¼ ìŠ¤ë ˆë“œì´ë‹¤.
- ì–´ë–¤ ë¡œì§ì´ ë™ê¸° í•¨ìˆ˜ë¡œë§Œ ì‹¤í–‰ë˜ë©´, ì‚¬ìš©ì ëŒ€ê¸°ì‹œê°„ì´ ê¸¸ì–´ì§€ëŠ” í•œê³„ê°€ ìˆë‹¤. ê·¸ë˜ì„œ ë¹„ë™ê¸° í†µì‹ ì´ í•„ìš”í•˜ë‹¤
- ë™ê¸°ì  vs ë¹„ë™ê¸°ì „
    - ë™ê¸°ì  :Â **ì¦‰ì‹œ**Â ì²˜ë¦¬
    - ë¹„ë™ê¸°ì  :Â **ë³„ë„ ìš”ì²­, ì‹¤í–‰ ëŒ€ê¸°, ë³´ë¥˜ ë“±**
- ë¹„ë™ê¸° ë°ì´í„° ì „ì†¡ì—ì„œ ì½œë°±í•¨ìˆ˜ê°€ í•„ìš”í•œ ì´ìœ ëŠ”, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ì— ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê³  ì„±ê³µ, ì‹¤íŒ¨ì— ë”°ë¼ ì–´ë– í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.
    - ì´ ì½”ë“œëŠ” ì„±ê³µ, ì‹¤íŒ¨ì— ë”°ë¼ ì‹¤í–‰ë˜ë¯€ë¡œ ë°”ë¡œ ì‹¤í–‰ë˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ê²°ê³¼ê°’ì— ë”°ë¼ ë¸Œë¼ìš°ì €ì— ë³´ì—¬ì§€ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸° í†µì‹ ì— ì½œë°±í•¨ìˆ˜ë¡œ ìš”ì²­í•´ ì½”ë“œë¥¼ ì§œê³  ë‚˜ì¤‘ì— ì‹¤í–‰í•˜ëŠ” ê²ƒì´ë‹¤.
    

### **Callback hell (ì½œë°± ì§€ì˜¥)**

ì½œë°±í•¨ìˆ˜ë¥¼ ìµëª… í•¨ìˆ˜ë¡œ ì „ë‹¬í•˜ëŠ” ê³¼ì •ì´ ë°˜ë³µë˜ì–´ ì½”ë“œì˜ depthê°€ êµ‰ì¥íˆ ê¹Šì–´ì§€ëŠ” í˜„ìƒ

- ì½”ë“œì˜ ê°€ë…ì„±ì´ ì•ˆì¢‹ìŒ
- ì½”ë“œ ìˆ˜ì •ë˜í•œ ì–´ë ¤ì›€

```jsx
setTimeout(function (name) {
  let coffeeList = name;
  console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ"
  
  setTimeout(function (name) {
    coffeeList += ', ' + name;
    console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ, ì•„ë©”ë¦¬ì¹´ë…¸"
    
    setTimeout(function (name) {
      coffeeList += ', ' + name;
      console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ, ì•„ë©”ë¦¬ì¹´ë…¸, ì¹´í˜ëª¨ì¹´"
      
      setTimeout(function (name) {
        coffeeList += ', ' + name;
        console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ, ì•„ë©”ë¦¬ì¹´ë…¸, ì¹´í˜ëª¨ì¹´, ì¹´í˜ë¼ë–¼"
      }, 500, 'ì¹´í˜ë¼ë–¼');
    }, 500, 'ì¹´í˜ëª¨ì¹´');
  }, 500, 'ì•„ë©”ë¦¬ì¹´ë…¸');
}, 500, 'ì—ìŠ¤í”„ë ˆì†Œ');
```

### â‡’ í•´ê²°ì±… 1: ê¸°ëª…í•¨ìˆ˜ë¡œ ë³€í™˜

```jsx
let coffeeList = '';

const addEspresso = function (name) {
  coffeeList = name;
  console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ"
  setTimeout(addAmericano, 500, 'ì•„ë©”ë¦¬ì¹´ë…¸');
};

const addAmericano = function (name) {
  coffeeList += ', ' + name;
  console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ, ì•„ë©”ë¦¬ì¹´ë…¸"
  setTimeout(addMocha, 500, 'ì¹´í˜ëª¨ì¹´');
};

const addMocha = function (name) {
  coffeeList += ', ' + name;
  console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ, ì•„ë©”ë¦¬ì¹´ë…¸, ì¹´í˜ëª¨ì¹´"
  setTimeout(addLatte, 500, 'ì¹´í˜ë¼ë–¼');
};

const addLatte = function (name) {
  coffeeList += ', ' + name;
  console.log(coffeeList); // "ì—ìŠ¤í”„ë ˆì†Œ, ì•„ë©”ë¦¬ì¹´ë…¸, ì¹´í˜ëª¨ì¹´, ì¹´í˜ë¼ë–¼"
};

setTimeout(addEspresso, 500, 'ì—ìŠ¤í”„ë ˆì†Œ');
```

### â‡’ **í•´ê²°ì±…2 (ë¹„ë™ê¸°ì  ì‘ì—…ì˜ ë™ê¸°ì  í‘œí˜„)**

1. **Promise (ES6)**
- ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ë©´ â†’ ì„±ê³µì˜ ë©”ì‹œì§€ì™€ í•¨ê»˜ ì²˜ë¦¬ëœ ê²°ê³¼ê°’ì„ ì „ë‹¬
- ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ ë°œìƒ â†’ Errorë¥¼ ì „ë‹¬
- **State : pending(ë³´ë¥˜) â†’ fulfilled(ì´í–‰) or rejected(ê±°ë¶€)**

ì˜ˆì‹œ

```jsx
new Promise(function (resolve) {
  setTimeout(function () {
    const name = 'ì—ìŠ¤í”„ë ˆì†Œ';
    console.log(name);
    resolve(name);
  }, 500);
}).then(function (prevName) {
  return new Promise(function (resolve) {
    setTimeout(function () {
      const name = prevName + ', ì•„ë©”ë¦¬ì¹´ë…¸';
      console.log(name);
      resolve(name);
    }, 500);
  });
}).then(function (prevName) {
  return new Promise(function (resolve) {
    setTimeout(function () {
      const name = prevName + ', ì¹´í˜ëª¨ì¹´';
      console.log(name);
      resolve(name);
    }, 500);
  });
}).then(function (prevName) {
  return new Promise(function (resolve) {
    setTimeout(function () {
      const name = prevName + ', ì¹´í˜ë¼ë–¼';
      console.log(name);
      resolve(name);
    }, 500);
  });
})
```

+ ë” ì§§ê²Œ í‘œí˜„

```jsx
onst addCoffee = function (name) {
  return function (prevName) {
    return new Promise(function (resolve) {
      setTimeout(function () {
        const newName = prevName ? (prevName + ', ' + name) : name;
        console.log(newName);
        resolve(newName);
      }, 500);
    });
  }
};

addCoffee('ì—ìŠ¤í”„ë ˆì†Œ')()
  .then(addCoffee('ì•„ë©”ë¦¬ì¹´ë…¸'))
  .then(addCoffee('ì¹´í˜ëª¨ì¹´'))
  .then(addCoffee('ì¹´í˜ë¼ë–¼'))
```

1. Generator (ES6) *â†’ ì—¬ê¸´ ì¢€ ì´í•´ê°€ ì˜ ì•ˆëœë‹¤*
- ES6ì— ì¶”ê°€ëœ '*'ì´ ë¶™ì€ í•¨ìˆ˜, ì—¬ëŸ¬ ê°œì˜ ê°’ì„ í•„ìš”ì— ë”°ë¼ í•˜ë‚˜ì”© ë°˜í™˜í•  ìˆ˜ ìˆë‹¤(yield)
- Generator í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë©´ Iteratorê°€ ë°˜í™˜ë˜ê³ , IteratorëŠ” nextë¼ëŠ” ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆìŒ
- next ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ Generator í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ê°€ì¥ ë¨¼ì € ë“±ì¥í•˜ëŠ” yieldì—ì„œ í•¨ìˆ˜ì˜ ì‹¤í–‰ì„ ë©ˆì¶¤
- ì´í›„ ë‹¤ì‹œ next ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì•ì„œ ë©ˆì·„ë˜ ë¶€ë¶„ë¶€í„° ì‹œì‘í•´ì„œ ê·¸ ë‹¤ìŒì— ë“±ì¥í•˜ëŠ” yieldì—ì„œ í•¨ìˆ˜ì˜ ì‹¤í–‰ì„ ë©ˆì¶¤
- ë¹„ë™ê¸° ì‘ì—…ì´ ì™„ë£Œë˜ëŠ” ì‹œì ë§ˆë‹¤ next ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ Generator í•¨ìˆ˜ ë‚´ë¶€ì˜ ì†ŒìŠ¤ê°€ ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ ë¨

```jsx
const addCoffee = function (prevName, name) {
  setTimeout(function () {
    coffeeMaker.next(prevName ? prevName + ', ' + name : name);
  }, 500);
};

const coffeeGenerator = function* () {
  const espresso = yield addCoffee('', 'ì—ìŠ¤í”„ë ˆì†Œ');
  console.log(espresso);
  
  const americano = yield addCoffee(espresso, 'ì•„ë©”ë¦¬ì¹´ë…¸');
  console.log(americano);
  
  const mocha = yield addCoffee(americano, 'ì¹´í˜ëª¨ì¹´');
  console.log(mocha);
  
  const latte = yield addCoffee(mocha, 'ì¹´í˜ë¼ë–¼');
  console.log(latte);
};

const coffeeMaker = coffeeGenerator();
coffeeMaker.next();
```

1. **async / await(ES8)**
- ES8(ES2017)ì—ì„œ ê°€ë…ì„±ì´ ë›°ì–´ë‚˜ë©´ì„œ ì‘ì„±ë²•ë„ ê°„ë‹¨í•œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì´ ì¶”ê°€
- **asyncë¥¼ ì‚¬ìš©í•˜ë©´ í•¨ìˆ˜ì˜ ì½”ë“œ ë¸”ë¡ì´ ìë™ìœ¼ë¡œ Promiseë¡œ ë³€í™˜ì´ ë˜ì–´ì§**
- ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³ ì í•˜ëŠ” í•¨ìˆ˜ ì•ì— async í‘œê¸°í•˜ê³ , í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì‹¤ì§ˆì ì¸ ë¹„ë™ê¸° ì‘ì—…ì´ í•„ìš”í•œ ìœ„ì¹˜ë§ˆë‹¤ await í‘œê¸°
- awaitëŠ” asyncë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥!
- await ë’¤ì˜ ë‚´ìš©ì´ Promiseë¡œ ìë™ ì „í™˜, í•´ë‹¹ ë‚´ìš©ì´ resolve ëœ ì´í›„ì—ì•¼ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰

```jsx
const addCoffee = function (name) {
  return new Promise(function (resolve) {
    setTimeout(function () {
      resolve(name);
    }, 500);
  });
};

const coffeeMaker = async function () {
  let coffeeList = '';
  const _addCoffee = async function (name) {
    coffeeList += (coffeeList ? ',' : '') + await addCoffee(name);
  };
  
  await _addCoffee('ì—ìŠ¤í”„ë ˆì†Œ');
  console.log(coffeeList);
  await _addCoffee('ì•„ë©”ë¦¬ì¹´ë…¸');
  console.log(coffeeList);
  await _addCoffee('ì¹´í˜ëª¨ì¹´');
  console.log(coffeeList);
  await _addCoffee('ì¹´í˜ë¼ë–¼');
  console.log(coffeeList);

};

coffeeMaker();
```

---
# ğŸÂ í€´ì¦ˆ

![Untitled](https://user-images.githubusercontent.com/95457808/172216129-1bd9c386-9123-46db-8598-4b654b58d451.png)

